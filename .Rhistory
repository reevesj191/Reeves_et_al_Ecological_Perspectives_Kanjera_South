---
title: Ecological perspectives on technological diversity at Kanjera South
author:
- name: Jonathan S. Reeves
email: jonathan.reeves@uni-tuebingen.de
affiliation: Eberhard Karls University of Tübingen
footnote: 1
- name: David R. Braun
email: David_Braun@gwu.edu
affiliation: The George Washington University
footnote: 2
- name: Emma Finestone
email: cat@example.com
affiliation: Max Planck Institute for the Science of Human History
footnote: 3
- name: Thomas Plummer
email: derek@example.com
affiliation: The Graduate Center, City University of New York
footnote: 4
address:
- code: Eberhard Karls University of Tübingen
address: Eberhard Karls University of Tübingen
- code: The George Washington University
address: The George Washington University
- code: Max Planck Institute for the Science of Human History
address: Max Planck Institute for the Science of Human History
- code: The Graduate Center, City University of New York
address: The Graduate Center, City University of New York
footnote:
- code: 1
text: "Corresponding Author"
knitr::opts_chunk$set(echo = FALSE,
warning = FALSE,
message = FALSE)
library(ggplot2)
library(grid)
library(gridExtra)
library(dplyr)
library(plyr)
library(citr)
library(FSA)
library(dunn.test)
library(knitr)
library(knitcitations)
cores <- read.csv("Data/CORES_2019_JHE_With_REDUX")
cores$RM <- toupper(cores$RM)
library(raster)
library(ggplot2)
library(ggsn)
library(ggsflabel)
library(ggrepel)
library(sf)
library(ggnewscale)
dem <- raster("Figures/Figure_data/Homa_Penninsula_DEM_30m2.tif")
dem[dem$Homa_Penninsula_DEM_30m2 <= 1134] <- NA
dem[dem$Homa_Penninsula_DEM_30m2 <= 1134] <- NA
aspect <- terrain(dem, opt = "aspect")
dem <- data.frame(rasterToPoints(dem))
hs <- hillShade(slope = slope,
aspect = aspect,
angle = 50,
direction = 315,
normalize = TRUE)
dem <- raster("Figures/Figure_data/Homa_Penninsula_DEM_30m2.tif")
dem[dem$Homa_Penninsula_DEM_30m2 <= 1134] <- NA
slope <- raster::terrain(dem, opt = "slope")
aspect <- terrain(dem, opt = "aspect")
dem <- data.frame(rasterToPoints(dem))
hs <- hillShade(slope = slope,
aspect = aspect,
angle = 50,
direction = 315,
normalize = TRUE)
hs <- data.frame(rasterToPoints(hs))
water <- read_sf("Figures/Figure_data/ke_major-rivers.shp")
kjs <- read_sf("Figures/Figure_data/KJS_WSG_84.shp")
st_geometry(kjs) <- NULL
ggplot()+
geom_raster(data = hs,aes(x=x, y=y, fill = layer),show.legend = FALSE)+
scale_fill_gradientn(colours = grey.colors(100,start = .5, end = 0))+
new_scale_fill()+
geom_raster(data = dem[dem$Homa_Penninsula_DEM_30m2 > 1134 & dem$Homa_Penninsula_DEM_30m2 < 2000,],
aes(x=x,y=y,fill = Homa_Penninsula_DEM_30m2),alpha = .4, inherit.aes = FALSE)+
geom_sf(data = water, color = "dodger blue1")+
scale_fill_gradientn(colours = terrain.colors(100), "Elevation (m)")+
geom_point(data = kjs, aes(x= X, y = Y)) +
geom_label_repel(data= kjs, aes(x = X, y = Y,label = Local),
box.padding   = 1,
point.padding = .5,
segment.color = 'black',
color = "black")+
north(location = "bottomleft", symbol = 10, x.min = 34.43,x.max = 34.9, y.min = -0.525, y.max = -.27195)+
scalebar(location = "bottomleft",dist_unit = "km",dist = 4, x.min = 34.44,x.max = 34.9, y.min = -0.528, y.max = -.275, transform = TRUE,st.dist = .025) +
scale_x_continuous(limits = c(34.42,34.9), expand = c(0,0))+
scale_y_continuous(limits = c(-0.55,-.275), expand = c(0,0))+
theme(panel.background = element_rect(fill = "dodger blue1"),
panel.grid = element_blank(),
panel.spacing = unit(1, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
dem <- raster("Figures/Figure_data/Homa_Penninsula_DEM_30m2.tif")
dem[dem$Homa_Penninsula_DEM_30m2 <= 1134] <- NA
slope <- raster::terrain(dem, opt = "slope")
aspect <- terrain(dem, opt = "aspect")
dem <- data.frame(rasterToPoints(dem))
hs <- hillShade(slope = slope,
aspect = aspect,
angle = 50,
direction = 315,
normalize = TRUE)
hs <- data.frame(rasterToPoints(hs))
water <- read_sf("Figures/Figure_data/ke_major-rivers.shp")
kjs <- read_sf("Figures/Figure_data/KJS_WSG_84.shp")
st_geometry(kjs) <- NULL
ggplot()+
geom_raster(data = hs,aes(x=x, y=y, fill = layer),show.legend = FALSE)+
scale_fill_gradientn(colours = grey.colors(100,start = .5, end = 0))+
new_scale_fill()+
#  geom_raster(data = dem[dem$Homa_Penninsula_DEM_30m2 > 1134 & dem$Homa_Penninsula_DEM_30m2 < 2000,],
#       aes(x=x,y=y,fill = Homa_Penninsula_DEM_30m2),alpha = .4, inherit.aes = FALSE)+
geom_sf(data = water, color = "dodger blue1")+
scale_fill_gradientn(colours = terrain.colors(100), "Elevation (m)")+
geom_point(data = kjs, aes(x= X, y = Y)) +
geom_label_repel(data= kjs, aes(x = X, y = Y,label = Local),
box.padding   = 1,
point.padding = .5,
segment.color = 'black',
color = "black")+
north(location = "bottomleft", symbol = 10, x.min = 34.43,x.max = 34.9, y.min = -0.525, y.max = -.27195)+
scalebar(location = "bottomleft",dist_unit = "km",dist = 4, x.min = 34.44,x.max = 34.9, y.min = -0.528, y.max = -.275, transform = TRUE,st.dist = .025) +
scale_x_continuous(limits = c(34.42,34.9), expand = c(0,0))+
scale_y_continuous(limits = c(-0.55,-.275), expand = c(0,0))+
theme(panel.background = element_rect(fill = "dodger blue1"),
panel.grid = element_blank(),
panel.spacing = unit(1, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
rivers2<-read_sf("Figures/Figure_data/Rivers_Homa_WGS.shp")
ggplot()+
geom_raster(data = hs,aes(x=x, y=y, fill = layer),show.legend = FALSE)+
scale_fill_gradientn(colours = grey.colors(100,start = .5, end = 0))+
new_scale_fill()+
#  geom_raster(data = dem[dem$Homa_Penninsula_DEM_30m2 > 1134 & dem$Homa_Penninsula_DEM_30m2 < 2000,],
#       aes(x=x,y=y,fill = Homa_Penninsula_DEM_30m2),alpha = .4, inherit.aes = FALSE)+
geom_sf(data = water, color = "dodger blue1")+
geom_sf(data = rivers2, color = "dodger blue2")+
scale_fill_gradientn(colours = terrain.colors(100), "Elevation (m)")+
geom_point(data = kjs, aes(x= X, y = Y)) +
geom_label_repel(data= kjs, aes(x = X, y = Y,label = Local),
box.padding   = 1,
point.padding = .5,
segment.color = 'black',
color = "black")+
north(location = "bottomleft", symbol = 10, x.min = 34.43,x.max = 34.9, y.min = -0.525, y.max = -.27195)+
scalebar(location = "bottomleft",dist_unit = "km",dist = 4, x.min = 34.44,x.max = 34.9, y.min = -0.528, y.max = -.275, transform = TRUE,st.dist = .025) +
scale_x_continuous(limits = c(34.42,34.9), expand = c(0,0))+
scale_y_continuous(limits = c(-0.55,-.275), expand = c(0,0))+
theme(panel.background = element_rect(fill = "dodger blue1"),
panel.grid = element_blank(),
panel.spacing = unit(1, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
library(raster)
library(ggplot2)
library(ggsn)
library(ggsflabel)
library(ggrepel)
library(sf)
library(ggnewscale)
dem <- raster("Figures/Figure_data/Homa_Penninsula_DEM_30m2.tif")
dem[dem$Homa_Penninsula_DEM_30m2 <= 1134] <- NA
slope <- raster::terrain(dem, opt = "slope")
aspect <- terrain(dem, opt = "aspect")
dem <- data.frame(rasterToPoints(dem))
hs <- hillShade(slope = slope,
aspect = aspect,
angle = 50,
direction = 315,
normalize = TRUE)
hs <- data.frame(rasterToPoints(hs))
water <- read_sf("Figures/Figure_data/ke_major-rivers.shp")
kjs <- read_sf("Figures/Figure_data/KJS_WSG_84.shp")
rivers2<-read_sf("Figures/Figure_data/Rivers_Homa_WGS.shp")
st_geometry(kjs) <- NULL
ggplot()+
geom_raster(data = hs,aes(x=x, y=y, fill = layer),show.legend = FALSE)+
scale_fill_gradientn(colours = grey.colors(100,start = .5, end = 0))+
new_scale_fill()+
#  geom_raster(data = dem[dem$Homa_Penninsula_DEM_30m2 > 1134 & dem$Homa_Penninsula_DEM_30m2 < 2000,],
#       aes(x=x,y=y,fill = Homa_Penninsula_DEM_30m2),alpha = .4, inherit.aes = FALSE)+
geom_sf(data = water, color = "dodger blue1")+
#geom_sf(data = rivers2, color = "dodger blue2")+
scale_fill_gradientn(colours = terrain.colors(100), "Elevation (m)")+
geom_point(data = kjs, aes(x= X, y = Y)) +
geom_label_repel(data= kjs, aes(x = X, y = Y,label = Local),
box.padding   = 1,
point.padding = .5,
segment.color = 'black',
color = "black")+
north(location = "bottomleft", symbol = 10, x.min = 34.43,x.max = 34.9, y.min = -0.525, y.max = -.27195)+
scalebar(location = "bottomleft",dist_unit = "km",dist = 4, x.min = 34.44,x.max = 34.9, y.min = -0.528, y.max = -.275, transform = TRUE,st.dist = .025) +
scale_x_continuous(limits = c(34.42,34.9), expand = c(0,0))+
scale_y_continuous(limits = c(-0.55,-.275), expand = c(0,0))+
theme(panel.background = element_rect(fill = "dodger blue1"),
panel.grid = element_blank(),
panel.spacing = unit(1, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
ggplot()+
geom_raster(data = hs,aes(x=x, y=y, fill = layer),show.legend = FALSE)+
scale_fill_gradientn(colours = grey.colors(100,start = .5, end = 0))+
new_scale_fill()+
#  geom_raster(data = dem[dem$Homa_Penninsula_DEM_30m2 > 1134 & dem$Homa_Penninsula_DEM_30m2 < 2000,],
#       aes(x=x,y=y,fill = Homa_Penninsula_DEM_30m2),alpha = .4, inherit.aes = FALSE)+
geom_sf(data = water, color = "dodger blue1")+
geom_sf(data = rivers2, color = "dodger blue2")+
scale_fill_gradientn(colours = terrain.colors(100), "Elevation (m)")+
geom_point(data = kjs, aes(x= X, y = Y)) +
geom_label_repel(data= kjs, aes(x = X, y = Y,label = Local),
box.padding   = 1,
point.padding = .5,
segment.color = 'black',
color = "black")+
north(location = "bottomleft", symbol = 10, x.min = 34.43,x.max = 34.9, y.min = -0.525, y.max = -.27195)+
scalebar(location = "bottomleft",dist_unit = "km",dist = 4, x.min = 34.44,x.max = 34.9, y.min = -0.528, y.max = -.275, transform = TRUE,st.dist = .025) +
scale_x_continuous(limits = c(34.42,34.9), expand = c(0,0))+
scale_y_continuous(limits = c(-0.55,-.275), expand = c(0,0))+
theme(panel.background = element_rect(fill = "dodger blue1"),
panel.grid = element_blank(),
panel.spacing = unit(1, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
rivers2<-read_sf("Figures/Figure_data/Rivers_Homa_WGS.shp")
rivers2
rivers2<-read_sf("Figures/Figure_data/Rivers_homa_WGS2.shp")
ggplot()+
geom_raster(data = hs,aes(x=x, y=y, fill = layer),show.legend = FALSE)+
scale_fill_gradientn(colours = grey.colors(100,start = .5, end = 0))+
new_scale_fill()+
#  geom_raster(data = dem[dem$Homa_Penninsula_DEM_30m2 > 1134 & dem$Homa_Penninsula_DEM_30m2 < 2000,],
#       aes(x=x,y=y,fill = Homa_Penninsula_DEM_30m2),alpha = .4, inherit.aes = FALSE)+
geom_sf(data = water, color = "dodger blue1")+
geom_sf(data = rivers2, color = "dodger blue2")+
scale_fill_gradientn(colours = terrain.colors(100), "Elevation (m)")+
geom_point(data = kjs, aes(x= X, y = Y)) +
geom_label_repel(data= kjs, aes(x = X, y = Y,label = Local),
box.padding   = 1,
point.padding = .5,
segment.color = 'black',
color = "black")+
north(location = "bottomleft", symbol = 10, x.min = 34.43,x.max = 34.9, y.min = -0.525, y.max = -.27195)+
scalebar(location = "bottomleft",dist_unit = "km",dist = 4, x.min = 34.44,x.max = 34.9, y.min = -0.528, y.max = -.275, transform = TRUE,st.dist = .025) +
scale_x_continuous(limits = c(34.42,34.9), expand = c(0,0))+
scale_y_continuous(limits = c(-0.55,-.275), expand = c(0,0))+
theme(panel.background = element_rect(fill = "dodger blue1"),
panel.grid = element_blank(),
panel.spacing = unit(1, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
ggplot()+
geom_raster(data = hs,aes(x=x, y=y, fill = layer),show.legend = FALSE)+
scale_fill_gradientn(colours = grey.colors(100,start = .5, end = 0))+
new_scale_fill()+
#  geom_raster(data = dem[dem$Homa_Penninsula_DEM_30m2 > 1134 & dem$Homa_Penninsula_DEM_30m2 < 2000,],
#       aes(x=x,y=y,fill = Homa_Penninsula_DEM_30m2),alpha = .4, inherit.aes = FALSE)+
# geom_sf(data = water, color = "dodger blue1")+
geom_sf(data = rivers2, color = "dodger blue2")+
scale_fill_gradientn(colours = terrain.colors(100), "Elevation (m)")+
geom_point(data = kjs, aes(x= X, y = Y)) +
geom_label_repel(data= kjs, aes(x = X, y = Y,label = Local),
box.padding   = 1,
point.padding = .5,
segment.color = 'black',
color = "black")+
north(location = "bottomleft", symbol = 10, x.min = 34.43,x.max = 34.9, y.min = -0.525, y.max = -.27195)+
scalebar(location = "bottomleft",dist_unit = "km",dist = 4, x.min = 34.44,x.max = 34.9, y.min = -0.528, y.max = -.275, transform = TRUE,st.dist = .025) +
scale_x_continuous(limits = c(34.42,34.9), expand = c(0,0))+
scale_y_continuous(limits = c(-0.55,-.275), expand = c(0,0))+
theme(panel.background = element_rect(fill = "dodger blue1"),
panel.grid = element_blank(),
panel.spacing = unit(1, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
library(ggsn)
library(raster)
library(ggplot2)
library(ggsn)
library(ggsflabel)
devtools::install_github("yutannihilation/ggsflabel")
install.packages("devtools")
devtools::install_github("yutannihilation/ggsflabel")
devtools::install_github("yutannihilation/ggsflabel")
install.packages("DescTools")
install.packages(c("ape", "aqp", "arm", "backports", "bestglm", "bibliometrix"))
install.packages("rayshader")
install.packages(c("carData", "caret", "checkmate", "class"))
library(ggrepel)
library(sf)
library(ggnewscale)
dem <- raster("Figures/Figure_data/Homa_Penninsula_DEM_30m2.tif")
dem[dem$Homa_Penninsula_DEM_30m2 <= 1134] <- NA
aspect <- terrain(dem, opt = "aspect")
dem <- data.frame(rasterToPoints(dem))
hs <- hillShade(slope = slope,
aspect = aspect,
angle = 50,
direction = 315,
normalize = TRUE)
hs <- data.frame(rasterToPoints(hs))
water <- read_sf("Figures/Figure_data/ke_major-rivers.shp")
kjs <- read_sf("Figures/Figure_data/KJS_WSG_84.shp")
rivers2<-read_sf("Figures/Figure_data/Rivers_homa_WGS2.shp")
st_geometry(kjs) <- NULL
ggplot()+
geom_raster(data = hs,aes(x=x, y=y, fill = layer),show.legend = FALSE)+
scale_fill_gradientn(colours = grey.colors(100,start = .5, end = 0))+
new_scale_fill()+
geom_raster(data = dem[dem$Homa_Penninsula_DEM_30m2 > 1134 & dem$Homa_Penninsula_DEM_30m2 < 2000,],
aes(x=x,y=y,fill = Homa_Penninsula_DEM_30m2),alpha = .4, inherit.aes = FALSE)+
# geom_sf(data = water, color = "dodger blue1")+
geom_sf(data = rivers2, color = "dodger blue2")+
scale_fill_gradientn(colours = terrain.colors(100), "Elevation (m)")+
geom_point(data = kjs, aes(x= X, y = Y)) +
geom_label_repel(data= kjs, aes(x = X, y = Y,label = Local),
box.padding   = 1,
point.padding = .5,
segment.color = 'black',
color = "black")+
north(location = "bottomleft", symbol = 10, x.min = 34.43,x.max = 34.9, y.min = -0.525, y.max = -.27195)+
scalebar(location = "bottomleft",dist_unit = "km",dist = 4, x.min = 34.44,x.max = 34.9, y.min = -0.528, y.max = -.275, transform = TRUE,st.dist = .025) +
scale_x_continuous(limits = c(34.42,34.9), expand = c(0,0))+
scale_y_continuous(limits = c(-0.55,-.275), expand = c(0,0))+
theme(panel.background = element_rect(fill = "dodger blue1"),
panel.grid = element_blank(),
panel.spacing = unit(1, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
install.packages(c("plotly", "plyr", "raster", "rasterVis", "reticulate", "rgdal", "rgeos", "RgoogleMaps", "rmarkdown", "sf"))
Samanga<-read_sf("Figures/Figure_data/SamangaFault_WGS.shp")
library(ggsn)
library(ggsflabel)
library(ggrepel)
library(sf)
library(ggnewscale)
dem <- raster("Figures/Figure_data/Homa_Penninsula_DEM_30m2.tif")
dem[dem$Homa_Penninsula_DEM_30m2 <= 1134] <- NA
dem[dem$Homa_Penninsula_DEM_30m2 <= 1134] <- NA
slope <- raster::terrain(dem, opt = "slope")
aspect <- terrain(dem, opt = "aspect")
dem <- raster("Figures/Figure_data/Homa_Penninsula_DEM_30m2.tif")
dem[dem$Homa_Penninsula_DEM_30m2 <= 1134] <- NA
slope <- raster::terrain(dem, opt = "slope")
library(raster)
library(ggplot2)
library(ggsn)
library(ggsflabel)
library(ggrepel)
library(sf)
library(ggnewscale)
dem <- raster("Figures/Figure_data/Homa_Penninsula_DEM_30m2.tif")
dem[dem$Homa_Penninsula_DEM_30m2 <= 1134] <- NA
slope <- raster::terrain(dem, opt = "slope")
aspect <- terrain(dem, opt = "aspect")
dem <- data.frame(rasterToPoints(dem))
dem <- raster("Figures/Figure_data/Homa_Penninsula_DEM_30m2.tif")
dem[dem$Homa_Penninsula_DEM_30m2 <= 1134] <- NA
slope <- raster::terrain(dem, opt = "slope")
aspect <- terrain(dem, opt = "aspect")
dem <- data.frame(rasterToPoints(dem))
hs <- hillShade(slope = slope,
aspect = aspect,
angle = 50,
direction = 315,
normalize = TRUE)
hs <- data.frame(rasterToPoints(hs))
water <- read_sf("Figures/Figure_data/ke_major-rivers.shp")
kjs <- read_sf("Figures/Figure_data/KJS_WSG_84.shp")
rivers2<-read_sf("Figures/Figure_data/Rivers_homa_WGS2.shp")
Samanga<-read_sf("Figures/Figure_data/SamangaFault_WGS.shp")
st_geometry(kjs) <- NULL
ggplot()+
geom_raster(data = hs,aes(x=x, y=y, fill = layer),show.legend = FALSE)+
scale_fill_gradientn(colours = grey.colors(100,start = .5, end = 0))+
new_scale_fill()+
#geom_raster(data = dem[dem$Homa_Penninsula_DEM_30m2 > 1134 & #dem$Homa_Penninsula_DEM_30m2 < 2000,],
#           aes(x=x,y=y,fill = Homa_Penninsula_DEM_30m2),alpha = .4, inherit.aes = FALSE)+
# geom_sf(data = water, color = "dodger blue1")+
geom_sf(data = rivers2, color = "dodger blue2")+
geom_sf(data = Samanga, color = "red")+
scale_fill_gradientn(colours = terrain.colors(100), "Elevation (m)")+
geom_point(data = kjs, aes(x= X, y = Y)) +
geom_label_repel(data= kjs, aes(x = X, y = Y,label = Local),
box.padding   = 1,
point.padding = .5,
segment.color = 'black',
color = "black")+
north(location = "bottomleft", symbol = 10, x.min = 34.43,x.max = 34.9, y.min = -0.525, y.max = -.27195)+
scalebar(location = "bottomleft",dist_unit = "km",dist = 4, x.min = 34.44,x.max = 34.9, y.min = -0.528, y.max = -.275, transform = TRUE,st.dist = .025) +
scale_x_continuous(limits = c(34.42,34.9), expand = c(0,0))+
scale_y_continuous(limits = c(-0.55,-.275), expand = c(0,0))+
theme(panel.background = element_rect(fill = "dodger blue1"),
panel.grid = element_blank(),
panel.spacing = unit(1, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
ggplot()+
geom_raster(data = hs,aes(x=x, y=y, fill = layer),show.legend = FALSE)+
scale_fill_gradientn(colours = grey.colors(100,start = .5, end = 0))+
new_scale_fill()+
# geom_raster(data = dem[dem$Homa_Penninsula_DEM_30m2 > 1134 & #dem$Homa_Penninsula_DEM_30m2 < 2000,],
#           aes(x=x,y=y,fill = Homa_Penninsula_DEM_30m2),alpha = .4, inherit.aes = FALSE)+
# geom_sf(data = water, color = "dodger blue1")+
geom_sf(data = rivers2, color = "dodger blue2")+
geom_sf(data = Samanga, color = "red", size=4)+
scale_fill_gradientn(colours = terrain.colors(100), "Elevation (m)")+
geom_point(data = kjs, aes(x= X, y = Y)) +
geom_label_repel(data= kjs, aes(x = X, y = Y,label = Local),
box.padding   = 1,
point.padding = .5,
segment.color = 'black',
color = "black")+
north(location = "bottomleft", symbol = 10, x.min = 34.43,x.max = 34.9, y.min = -0.525, y.max = -.27195)+
scalebar(location = "bottomleft",dist_unit = "km",dist = 4, x.min = 34.44,x.max = 34.9, y.min = -0.528, y.max = -.275, transform = TRUE,st.dist = .025) +
scale_x_continuous(limits = c(34.42,34.9), expand = c(0,0))+
scale_y_continuous(limits = c(-0.55,-.275), expand = c(0,0))+
theme(panel.background = element_rect(fill = "dodger blue1"),
panel.grid = element_blank(),
panel.spacing = unit(1, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
ggplot()+
geom_raster(data = hs,aes(x=x, y=y, fill = layer),show.legend = FALSE)+
scale_fill_gradientn(colours = grey.colors(100,start = .5, end = 0))+
new_scale_fill()+
# geom_raster(data = dem[dem$Homa_Penninsula_DEM_30m2 > 1134 & #dem$Homa_Penninsula_DEM_30m2 < 2000,],
#           aes(x=x,y=y,fill = Homa_Penninsula_DEM_30m2),alpha = .4, inherit.aes = FALSE)+
# geom_sf(data = water, color = "dodger blue1")+
geom_sf(data = rivers2, color = "dodger blue2")+
geom_sf(data = Samanga, color = "red", size=3)+
scale_fill_gradientn(colours = terrain.colors(100), "Elevation (m)")+
geom_point(data = kjs, aes(x= X, y = Y)) +
geom_label_repel(data= kjs, aes(x = X, y = Y,label = Local),
box.padding   = 1,
point.padding = .5,
segment.color = 'black',
color = "black")+
north(location = "bottomleft", symbol = 10, x.min = 34.43,x.max = 34.9, y.min = -0.525, y.max = -.27195)+
scalebar(location = "bottomleft",dist_unit = "km",dist = 4, x.min = 34.44,x.max = 34.9, y.min = -0.528, y.max = -.275, transform = TRUE,st.dist = .025) +
scale_x_continuous(limits = c(34.42,34.9), expand = c(0,0))+
scale_y_continuous(limits = c(-0.55,-.275), expand = c(0,0))+
theme(panel.background = element_rect(fill = "dodger blue1"),
panel.grid = element_blank(),
panel.spacing = unit(1, "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
